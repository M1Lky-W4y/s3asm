# s3asm
Tools for (dis)assembling Motorola m68k binaries for the General Music S2/S3 Music Processor

## Disassembly
Use *s3dasm* included in this package. For usage details, run `s3dasm -h`.

### s3dasm dependencies
capstone + python bindings (http://www.capstone-engine.org/)

As of March 2016, the m68k target is not yet supported in the official release of capstone. It is necessary to use the *next* branch of their [github repo](https://github.com/aquynh/capstone) and compile manually. See [this document](https://github.com/aquynh/capstone/wiki/Next-branch) for instructions.

The python bindings are usually generated by running `make install` in `python/bindings`. If *s3dasm* cannot find the module `capstone`, try running `sudo python setup.py install` manually.

### Example
```
# try disassembling program.bin as one code segment
./s3dasm -o program.asm program.bin
# read segment information from control.txt
./s3dasm -c control.txt -o program.asm program.bin      # or make dasm
# run a second pass after disassembling to replace constant branch addresses by labels (required by both vasm and asmx)
./s3dasm -l -c control.txt -o program.asm program.bin   # or make dasm-label
```

## Assembly
Two assemblers are currently being investigated:

* [vasm](http://sun.hasenbraten.de/vasm/)
* [asmx](http://xi6.com/projects/asmx/)

### vasm notes
Building vasm: `make CPU=m68k SYNTX=mot`

Using vasm: `vasmm68k_mot -m68000 -no-opt -Fbin -o program.vasm program.asm` or `make vasm`

### asmx notes
Using asmx: `asm68k -C 68000 -b -o program.asmx program.asm` or `make asmx`
